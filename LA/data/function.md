# LA_Sample_Taiwan_Pantos_Atomy_Performance_0307: function listup

```txt
/LA/data/LA_Sample_Taiwan_Pantos_Atomy_Performance_0307.xlsx
```

## 요청자료

최초의 Input이자 최종 Output이 합쳐져있는 내용

| Value      | from | Explanation |
| :--------- | :---------- | :---------- | 
| `주문코드` & `B2C 구분` |`given`| B2B, B2C(택배), B2C(편의점) |
| `SKU코드` |`given`| 품목번호(상품의 종류를 의미) |
| `박스당PCS`|| |
| `총수량` |`given`| 해당 `오더번호`에 들어있는 상품`SKU코드`의 요청 개수 | 
|`PCS출하`|`?`||
| `피킹수량` |`calculated`| =IF(`PCS출하`<2,`PCS출하`,QUOTIENT(`PCS출하`,2)+MOD(`PCS출하`,2)) | 
|`가로(mm)`|`given`| mm | 
|`세로(mm)`|`given`| mm | 
|`높이(mm)`|`given`| mm | 
|`단위부피`|`calculated`| `가로(mm)` * `높이(mm)` * `세로(mm)` * 10^(-6)| 
|`수량의 부피`|`calculated`| `PCS출하` * `단위부피`|
|`오더번호`|`given`| 고객별 주문번호로 생각, 같은 `오더번호`여도 `SKU코드`에 따라 분리되어 데이터를 가져온다.| 
|`합포여부`|||
|`1박스이상되는 주문_표시`|`calculated`|=if B2C>53.41 == "*", = if B2B>55.80 == "**"|
|`박스번호설정`|`calculated`||
|`박스번호설정_최종`|`calculated`|=IF(`박스번호설정`="",1,`박스번호설정`)|
|`location`|`calculated`|location 할당에서 확인하기|

### 오더의 박스수 정하기

<mark>First step function</mark>
1.	오더를 B2C와 B2B로 구분해서 B2B는 55.80리터, B2C는 최대 53.41리터를 기준으로 초과되는 오더만 이 sheet에서 *과 **로 표시하였음
2. "요청자료"sheet에 오더번호를 기준으로  이 sheet의 D열값을 vlookup으로 붙임
3. "요청자료"sheet에서 *,** 이 붙은 오더만 필터해서 각 행의 용적을 보고	B2C와 B2B의 최대용적을 넘지 않도록 각 레코드에 박스번호를 1,2 설정.					     
4. 	*,**이 붙지 않은 오더의 행은 전부 1로 설정
    - 왜냐하면 용량에 맞게 박스사이즈가 결정되서 투입될 예정인데 시뮬에서는 1박스만 설정가능하므로,B2B와 B2C의 최대용량을 넘지않는 모든 오더는 1박스에 담긴다고 가정한 것임.					

**[Summarize by own flow]**

1. [요청자료/`가로(mm)`], [요청자료/`세로(mm)`], [요청자로/`높이(mm)`]에서 `단위부피` 계산 
2. `수량의 부피` = `총수량` * `단위부피` 
3. 동일한 `오더번호` 기준으로 각 `SKU번호`별 `수량의 부피`를 모두 summaxtion
4. `주문코드` 기준 B2B 및 B2C 분류
5. `박스번호설정_최종` 계산   
    1. `주문코드` B2B & SUM(`수량의 부피`) >= 55.80 일시, `**` 부여 
    2. `주문코드` B2C & SUM(`수량의 부피`) >= 53.41 일시, `*` 부여 
    3. SUM(`수량의 부피`)이 각 `주문코드` 기준으로 최대용적이 넘지 않도록 `*`, `**`가 붙은 `오더번호`애 대해서 박스별 분배를 시행
    4. 이때, 분배는 `오더번호` 기준으로 stack하다가, 최대용적률을 넘으면 박스번호를 그 이후를 분배

**[생각되는 에러 사항]**
- [ ] 하나의 상품에 대해서 최대용적율이 넘을때는 에러를 발생시킬것으로 예상


| Value      | from | Explanation |
| :--------- | :---------- | :---------- |
|`오더번호`|`given`|[요청자료] `오더번호`|
|`B2C구분`|`given`|`주문코드` 앞 3자리|
|`개수 : Sku Code`|`calculated`| `오더번호`기준 grouped `SKU코드`의 개수: 개인적으로 굳이 불필요한 값으로 생각|
|`합계: 수량의 부피`|`calculated`| `오더번호`기준 grouped `SKU코드`의 개수에 대해서 SUM(`주문코드` * `수량의 부피`)|


|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
|``|||
